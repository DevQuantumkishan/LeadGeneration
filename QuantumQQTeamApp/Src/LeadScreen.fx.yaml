LeadScreen As screen:
    OnVisible: |-
        =Set(VarChatMessage,false);
        Set(VarLeadDetails,true);
        Set(VarLeadProposal,false);
        Set(VarLeadMessages,false);
        Set(VarPopUpEstimateNumber,false);
        Refresh(LeadInformations);
        Refresh(LeadImages);
        Refresh(LeadChats);

    ctnmainLdS As groupContainer.verticalAutoLayoutContainer:
        Height: =Parent.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =7
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Width: =Parent.Width
        Y: =ctnHeaderLeadScreen.Height+ctnHeaderLeadScreen.Y
        ZIndex: =1

        ctnbackLdS As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.Start
            FillPortions: =0
            Height: =80
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGap: =20
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            Width: =Parent.Width
            ZIndex: =2

            btnbackLdS As button:
                BorderColor: =//ColorFade(Self.Fill, -15%)
                BorderThickness: =0
                Fill: =Header.SHRed
                FocusedBorderThickness: =0
                HoverFill: =//ColorFade(RGBA(56, 96, 178, 1), -20%)
                OnSelect: |-
                    =Set(VarPopUpInprogress,false);
                    Reset(txtinptestimatenumber);
                    Navigate(LeadListScreen)
                PressedFill: =//Self.Color
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Text: =" Back"
                ZIndex: =1

        ctnmechanicnameLdS As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =40
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            ZIndex: =3

            lblmechanicnameLdS As label:
                FontWeight: =FontWeight.Semibold
                Size: =16
                Text: ="Mechanic Name"
                Width: =200
                ZIndex: =1

            lblmechanicnamevalueLdS As label:
                Size: =16
                Text: =glryleadlistLS.Selected.MechanicName
                Width: =Parent.Width/2
                ZIndex: =2

        ctncontractnumberLdS As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =40
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            ZIndex: =5

            lblcontractnumberLdS As label:
                FontWeight: =FontWeight.Semibold
                Size: =16
                Text: ="Contract No."
                Width: =200
                ZIndex: =1

            lblcontractnumbervalueLdS As label:
                Size: =16
                Text: =glryleadlistLS.Selected.'ContractNumber '
                Width: =Parent.Width/2
                ZIndex: =2

        ctnestimatenumberLdS As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =40
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            ZIndex: =6

            lblestimatenumberLdS As label:
                FontWeight: =FontWeight.Semibold
                Size: =16
                Text: ="Estimate No."
                Width: =200
                ZIndex: =1

            lblestimatenumbervalueLdS As label:
                Size: =16
                Text: ="Not Available"
                Width: =Parent.Width/2
                ZIndex: =2

        ctnqqteamnameLdS As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =40
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            Width: =Parent.Width
            ZIndex: =7

            lblqqteamnameLdS As label:
                FontWeight: =FontWeight.Semibold
                Size: =16
                Text: ="QQ Team name"
                Width: =200
                ZIndex: =1

            lblqqteamnamevalueLdS As label:
                Size: =16
                Text: =If(!IsBlank(LookUp(LeadInformations,LeadStatus="Submitted" && ID=glryleadlistLS.Selected.ID)),"Not Assigned",LookUp(LeadInformations,ID=glryleadlistLS.Selected.ID,QQTeamName))
                Width: =Parent.Width
                ZIndex: =2

        ctnglryheadingLdS As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =60
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            Width: =Parent.Width //500
            ZIndex: =8

            ctnleaddetailstabLdS As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =Parent.Height
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutDirection: =LayoutDirection.Vertical
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =50
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                Width: =180
                ZIndex: =1

                btnleaddetailstabLdS As button:
                    BorderThickness: =0
                    Color: =If(VarLeadDetails= true,Header.Black,Header.SHRed)
                    Fill: =Header.White
                    FocusedBorderThickness: =
                    HoverColor: =//RGBA(255, 255, 255, 1)
                    HoverFill: =//ColorFade(RGBA(56, 96, 178, 1), -20%)
                    OnSelect: |-
                        =Set(VarLeadDetails,true);
                        Set(VarLeadProposal,false);
                        Set(VarLeadMessages,false);
                    PressedFill: =//Self.Color
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: ="Lead Details"
                    Width: =170
                    ZIndex: =1

                icnhorizontalleaddetailsLdS As icon.Add:
                    Color: =Header.SHRed
                    Fill: =Header.SHRed
                    Height: =3
                    Icon: =Icon.HorizontalLine
                    Visible: =If(VarLeadDetails= true,true,false)
                    Width: =150
                    ZIndex: =2

            ctnleadproposaltabLdS As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =Parent.Height
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutDirection: =LayoutDirection.Vertical
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =50
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                Visible: =If((glryleadlistLS.Selected.LeadStatus="InProgress" /*||glryleadlistLS.Selected.LeadStatus="Quoted"*/) && glryleadlistLS.Selected.QQTeamName=User().FullName,true,false)
                Width: =180
                ZIndex: =2

                btnleadproposaltabLdS As button:
                    BorderThickness: =0
                    Color: =If(VarLeadProposal= true,Header.Black,Header.Red)
                    Fill: =Header.White
                    FocusedBorderThickness: =
                    HoverColor: =//RGBA(255, 255, 255, 1)
                    HoverFill: =//ColorFade(RGBA(56, 96, 178, 1), -20%)
                    OnSelect: |
                        =Set(VarLeadDetails,false);
                        Set(VarLeadProposal,true);
                        Set(VarLeadMessages,false);
                    PressedFill: =//Self.Color
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: ="Lead Proposal"
                    Width: =170
                    ZIndex: =1

                icnhorizontalleadproposalLdS As icon.Add:
                    Color: =Header.Red
                    Fill: =Header.Red
                    Height: =3
                    Icon: =Icon.HorizontalLine
                    Visible: =If(VarLeadProposal= true,true,false)
                    Width: =150
                    ZIndex: =2

            ctnleadmessagestabLdS As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =Parent.Height
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutDirection: =LayoutDirection.Vertical
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =50
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                Width: =180
                ZIndex: =3

                btnleadmessagetabLdS As button:
                    BorderThickness: =0
                    Color: =If(VarLeadMessages= true,Header.Black,Header.SHRed)
                    Fill: =Header.White
                    FocusedBorderThickness: =
                    HoverColor: =//RGBA(255, 255, 255, 1)
                    HoverFill: =//ColorFade(RGBA(56, 96, 178, 1), -20%)
                    OnSelect: |-
                        =Set(VarLeadDetails,false);
                        Set(VarLeadProposal,false);
                        Set(VarLeadMessages,true);
                    PressedFill: =//Self.Color
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: ="Lead Messages"
                    Width: =170
                    ZIndex: =1

                icnhorizontalleadmessageLdS As icon.Add:
                    Color: =Header.Red
                    Fill: =Header.Red
                    Height: =3
                    Icon: =Icon.HorizontalLine
                    Visible: =If(VarLeadMessages= true,true,false)
                    Width: =150
                    ZIndex: =2

            Container1 As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.Start
                Height: =Parent.Height
                LayoutJustifyContent: =LayoutJustifyContent.End
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingRight: =40
                ZIndex: =4

                btnnewmessageLdS As button:
                    AlignInContainer: =AlignInContainer.Center
                    DisplayMode: =If((glryleadlistLS.Selected.LeadStatus="Quoted" || glryleadlistLS.Selected.LeadStatus="Rejected"),DisplayMode.Disabled,DisplayMode.Edit)
                    Fill: =Header.SHRed
                    Height: =30
                    HoverFill: =//ColorFade(RGBA(56, 96, 178, 1), -20%)
                    OnSelect: =Set(VarChatMessage,true)
                    Text: ="+ New Message"
                    Visible: =VarLeadMessages
                    Width: =200
                    X: =Parent.Width-Self.Width-20
                    Y: =10
                    ZIndex: =1

        ctnhorizontallineleaddetailsglryLdS As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =2
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            Width: =Parent.Width
            ZIndex: =9

            icnhorizontallineleaddetailsglryLdS As icon.AddDocument:
                Color: =RGBA(217, 217, 217, 1)
                Fill: =RGBA(217, 217, 217, 1)
                Height: =Parent.Height
                Icon: =Icon.HorizontalLine
                Width: =Parent.Width-40
                ZIndex: =1

        ctnglrymainLdS As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Parent.Height+100
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =10

            ctnchatmessageLdS As groupContainer.manualLayoutContainer:
                BorderColor: =RGBA(0, 0, 0, 0.16)
                BorderThickness: =2
                Fill: =RGBA(255,255,255,1) //RGBA(249, 249, 249, 1)
                Height: =Parent.Height
                Visible: =VarLeadMessages
                Width: =Parent.Width-40
                X: =20
                ZIndex: =1

                Label14_2 As label:
                    Color: =RGBA(255, 0, 0, 1)
                    Height: =200
                    Size: =50
                    Text: ="Comming Soon ...."
                    Visible: =false
                    Width: =800
                    X: =160
                    Y: =140
                    ZIndex: =1

                glrychatmessageLdS As gallery.variableTemplateHeightGallery:
                    DelayItemLoading: =true
                    Fill: |-
                        =//RGBA(237,237,237,1) 
                        RGBA(0, 0, 0, 0)
                    Height: =Parent.Height-100
                    Items: |-
                        =//Sort(Filter(Chats,LeadNo.crd59_leadinformationid=Gallery1.Selected.LeadInformation),Datetime,SortOrder.Ascending)
                        Sort(Filter(LeadChats,LeadInformationLID.ID=glryleadlistLS.Selected.ID),'Modified On',SortOrder.Descending)
                        /*[{
                            message:"Check doors again",
                            time:"12.59 AM",
                            name:"QQ Team",
                            from:"you"
                        },
                        {
                            message:"Gap problem",
                            time:"1.15 AM",
                            name:"Schindler guest",
                            from:"me"
                        },
                        {
                            message:"Okay",
                            time:"2.05 AM",
                            name:"QQ Team",
                            from:"you"
                        }
                        ]*/
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    OnSelect: |-
                        =/*Patch(Chats,
                                ThisItem,
                                {
                                   Read:true
                                }
                            );
                        
                        Set(MessageRead,true);
                        Refresh(Chats);*/
                    TemplateSize: =lblchatmessageLdS.Height+lblsenderreceiverLdS.Height
                    Width: =Parent.Width
                    Y: =//btnnewmessageLdS.Height+btnnewmessageLdS.Y+10
                    ZIndex: =2

                    rectmessageLdS As rectangle:
                        Fill: =If(ThisItem.IsQQApp=true,RGBA(255,255,255,1),RGBA(237, 237, 237, 1))
                        Height: =lblchatmessageLdS.Height+lblsenderreceiverLdS.Height
                        OnSelect: =Select(Parent)
                        Width: =Parent.Width-30
                        X: =10
                        ZIndex: =1

                    lblchatmessageLdS As label:
                        Align: =If(ThisItem.IsQQApp=true,Align.Right,Align.Left)
                        AutoHeight: =true
                        Font: =Font.Arial
                        Height: =25
                        OnSelect: =Select(Parent)
                        PaddingLeft: =20
                        PaddingRight: =50
                        Size: =18
                        Text: =ThisItem.Message
                        Width: =Parent.Width
                        ZIndex: =2

                    lblsenderreceiverLdS As label:
                        Align: =If(ThisItem.IsQQApp=true,Align.Right,Align.Left)
                        Font: =Font.Arial
                        Height: =30
                        OnSelect: =Select(Parent)
                        PaddingLeft: =20
                        PaddingRight: =50
                        Size: =14
                        Text: |-
                            =ThisItem.FromName & "  " &ThisItem.'Modified On'
                            //If(ThisItem.IsQQApp=true,ThisItem.FromName &  " " &ThisItem.'Modified On',ThisItem.ToName & " " & ThisItem.'Modified On')
                        Width: =Parent.Width
                        Y: =lblchatmessageLdS.Y+lblchatmessageLdS.Height
                        ZIndex: =3

                    rectmessagesepratorLdS As rectangle:
                        Fill: =RGBA(102, 102, 102, 1)
                        Height: =3
                        Width: =Parent.Width-30
                        X: =10
                        Y: =lblsenderreceiverLdS.Height+lblsenderreceiverLdS.Y+5
                        ZIndex: =4

                txtinptchatmessageldS As text:
                    BorderColor: =Self.Color
                    Color: =RGBA(255, 0, 0, 1)
                    Default: =""
                    Fill: =RGBA(0, 0, 0, 0)
                    Font: =Font.Arial
                    Height: =80
                    HintText: ="Enter message"
                    HoverBorderColor: =RGBA(255, 0, 0, 1)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Mode: =TextMode.MultiLine
                    Size: =18
                    Visible: =false
                    Width: =Parent.Width-130
                    X: =10
                    Y: =glrychatmessageLdS.Height+glrychatmessageLdS.Y
                    ZIndex: =3

                icnsendchatmessageLdS As icon.Send:
                    BorderColor: =Self.Color
                    BorderThickness: =2
                    Color: =RGBA(255, 0, 0, 1)
                    Height: =80
                    Icon: =Icon.Send
                    OnSelect: |-
                        =/*Patch(Chats,Defaults(Chats),
                                    {
                                        Name:"Chat",
                                        From:myMail,
                                     // To:personEmail,
                                        Message:TextInput1_2.Text,
                                        LeadNo:LookUp(LeadInformations,LeadInformation=Gallery1.Selected.LeadInformation),
                                        Datetime:Now()
                                    }
                                );
                        Refresh(Chats);
                        Reset(TextInput1_2);*/
                    PaddingBottom: =10
                    PaddingLeft: =15
                    PaddingRight: =15
                    PaddingTop: =10
                    Visible: =false
                    Width: =80
                    X: =txtinptchatmessageldS.Width+txtinptchatmessageldS.X
                    Y: =glrychatmessageLdS.Height+glrychatmessageLdS.Y
                    ZIndex: =4

            ctnleaddetailsLdS As groupContainer.manualLayoutContainer:
                BorderColor: =RGBA(0, 0, 0, 0.16)
                BorderThickness: =2
                Fill: =RGBA(249, 249, 249, 1)
                Height: =Parent.Height+100
                Visible: =VarLeadDetails
                Width: =Parent.Width-40
                X: =20
                ZIndex: =3

                ctnverleaddetailsLdS As groupContainer.verticalAutoLayoutContainer:
                    Height: =Parent.Height
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMode: =LayoutMode.Auto
                    LayoutOverflowY: =LayoutOverflow.Scroll
                    PaddingRight: =20
                    Width: =Parent.Width-20
                    X: =Parent.X
                    Y: =Parent.Y
                    ZIndex: =5

                    ctnaddressdetailsLdS As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: |-
                            =If(
                                ctnbuildingnameleaddetailsLdS.Height > ctnaddressleaddetailsLdS.Height,
                                ctnbuildingnameleaddetailsLdS.Height+30,
                                ctnaddressleaddetailsLdS.Height+30
                            )
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Width: =Parent.Width
                        X: =60
                        Y: =60
                        ZIndex: =1

                        ctncontractnumberleaddetailLdS As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =lblbuildingnamevalueleaddetailsLdS.Height+lblbuildingnameleaddetailsLdS.Height+20
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutJustifyContent: =LayoutJustifyContent.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =1

                            lblcontractnumberleaddetailLdS As label:
                                FontWeight: =FontWeight.Bold
                                Height: =50
                                Text: ="Contract Number"
                                Width: =Parent.Width
                                ZIndex: =1

                            lblcontractnumbervalueleaddetailsLdS As label:
                                Color: =Header.SHRed
                                Text: =glryleadlistLS.Selected.'ContractNumber '
                                Width: =Parent.Width
                                ZIndex: =2

                        ctnzipcodeleaddetailsLdS As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =lblbuildingnamevalueleaddetailsLdS.Height+lblbuildingnameleaddetailsLdS.Height+20
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutJustifyContent: =LayoutJustifyContent.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =2

                            lblzipcodeleaddetailsLdS As label:
                                FontWeight: =FontWeight.Bold
                                Height: =50
                                Text: ="Zip Code"
                                Width: =Parent.Width
                                ZIndex: =1

                            lblzipcodevalueleaddetailsLdS As label:
                                Color: =Header.SHRed
                                Text: =glryleadlistLS.Selected.'ZipCode '
                                Width: =Parent.Width
                                ZIndex: =2

                        ctnbuildingnameleaddetailsLdS As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =lblbuildingnamevalueleaddetailsLdS.Height+lblbuildingnameleaddetailsLdS.Height
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutJustifyContent: =LayoutJustifyContent.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =3

                            lblbuildingnameleaddetailsLdS As label:
                                FontWeight: =FontWeight.Bold
                                Height: =50
                                Text: ="Building Name"
                                Width: =Parent.Width
                                ZIndex: =1

                            lblbuildingnamevalueleaddetailsLdS As label:
                                AutoHeight: =true
                                Color: =Header.SHRed
                                Text: =glryleadlistLS.Selected.'BuildingName '
                                Width: =Parent.Width
                                ZIndex: =2

                        ctnaddressleaddetailsLdS As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =lbladdresslvalueeaddetailsLdS.Height+lbladdressleaddetailsLdS.Height
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutJustifyContent: =LayoutJustifyContent.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =4

                            lbladdressleaddetailsLdS As label:
                                FontWeight: =FontWeight.Bold
                                Height: =50
                                Text: ="Address"
                                Width: =Parent.Width
                                ZIndex: =1

                            lbladdresslvalueeaddetailsLdS As label:
                                AutoHeight: =true
                                Color: =Header.SHRed
                                Text: =glryleadlistLS.Selected.Address
                                Width: =Parent.Width
                                ZIndex: =2

                    icnaddressleaddetailsLdS As icon.Add:
                        Color: =RGBA(217, 217, 217, 1)
                        Fill: =RGBA(217, 217, 217, 1)
                        Height: =2
                        Icon: =Icon.HorizontalLine
                        Width: =Parent.Width-20
                        ZIndex: =2

                    ctnleadinfoleaddetailsLdS As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: |
                            =If(
                                ctnemailleaddetailsLdS.Height > ctnestimatedhoursleaddetailsLdS.Height,
                                ctnemailleaddetailsLdS.Height+30,
                                ctnestimatedhoursleaddetailsLdS.Height+30
                            )
                            //ctnnotesleaddetailsLdS.Height+30
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Width: =Parent.Width
                        X: =60
                        Y: =60
                        ZIndex: =3

                        ctnstatusdateleaddetailsLdS As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =lblemailvalueleaddetailsLdS.Height+lblemailleaddetailsLdS.Height+20
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutJustifyContent: =LayoutJustifyContent.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =1

                            lblstatusdateleaddetailsLdS As label:
                                FontWeight: =FontWeight.Bold
                                Height: =50
                                Text: ="Status Date"
                                Width: =Parent.Width
                                ZIndex: =1

                            lblstatusdatevalueleaddetailsLdS As label:
                                Color: =Header.SHRed
                                Text: =glryleadlistLS.Selected.StatusDate
                                Width: =Parent.Width
                                ZIndex: =2

                        ctnnotesleaddetailsLdS As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =lblemailvalueleaddetailsLdS.Height+lblemailleaddetailsLdS.Height+20
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutJustifyContent: =LayoutJustifyContent.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =2

                            lblnotesleaddetailsLdS As label:
                                FontWeight: =FontWeight.Bold
                                Height: =50
                                Text: ="Notes"
                                Width: =Parent.Width
                                ZIndex: =1

                            lblnotesvaluedetailsLdS As label:
                                Color: =Header.SHRed
                                Text: =glryleadlistLS.Selected.Notes
                                Width: =Parent.Width
                                ZIndex: =2

                        ctnemailleaddetailsLdS As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =lblemailvalueleaddetailsLdS.Height+lblemailleaddetailsLdS.Height+20
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutJustifyContent: =LayoutJustifyContent.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =3

                            lblemailleaddetailsLdS As label:
                                FontWeight: =FontWeight.Bold
                                Height: =50
                                Text: ="Email"
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width
                                ZIndex: =1

                            lblemailvalueleaddetailsLdS As label:
                                AutoHeight: =true
                                Color: =Header.SHRed
                                Size: =12
                                Text: =glryleadlistLS.Selected.Email
                                Width: =Parent.Width
                                ZIndex: =2

                        ctnestimatedhoursleaddetailsLdS As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =lblestimatedhoursvalueleaddetailsLdS.Height+lblestimatedhoursleaddetailsLdS.Height+20
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutJustifyContent: =LayoutJustifyContent.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =4

                            lblestimatedhoursleaddetailsLdS As label:
                                FontWeight: =FontWeight.Bold
                                Height: =50
                                Text: ="Estimated Hours"
                                Width: =Parent.Width
                                ZIndex: =1

                            lblestimatedhoursvalueleaddetailsLdS As label:
                                AutoHeight: =true
                                Color: =Header.SHRed
                                Text: =glryleadlistLS.Selected.'EstimatedHours '
                                Width: =Parent.Width
                                ZIndex: =2

                    icnleadinfoleaddetailsLdS As icon.Add:
                        Color: =RGBA(217, 217, 217, 1)
                        Fill: =RGBA(217, 217, 217, 1)
                        Height: =2
                        Icon: =Icon.HorizontalLine
                        Width: =Parent.Width-20
                        ZIndex: =4

                    ctnunitinfoleaddetailsLdS As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: |-
                            =If(
                                ctnunitdescriptionleaddetailsLdS.Height > ctncustomscopeofworkleaddetailsLdS.Height,
                                ctnunitdescriptionleaddetailsLdS.Height + 30,
                                ctncustomscopeofworkleaddetailsLdS.Height + 30
                            )
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Width: =Parent.Width
                        X: =20
                        Y: =20
                        ZIndex: =5

                        ctnnoofunitsleaddetailsLdS As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =lblbuildingnamevalueleaddetailsLdS.Height+lblbuildingnameleaddetailsLdS.Height+20
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutJustifyContent: =LayoutJustifyContent.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =1

                            lblnoofunitsladdetailsLdS As label:
                                FontWeight: =FontWeight.Bold
                                Height: =50
                                Text: ="No of units"
                                Width: =Parent.Width
                                ZIndex: =1

                            lblnoofunitsvalueleaddetailsLdS As label:
                                Color: =Header.SHRed
                                Text: =glryleadlistLS.Selected.NumberofUnits
                                Width: =Parent.Width
                                ZIndex: =2

                        ctnunitdescriptionleaddetailsLdS As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =lblunitdescriptionleaddescriptionLdS.Height+lblunitdescriptionleaddetailsLdS.Height+20
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutJustifyContent: =LayoutJustifyContent.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =2

                            lblunitdescriptionleaddetailsLdS As label:
                                FontWeight: =FontWeight.Bold
                                Height: =50
                                Text: ="Unit Description"
                                Width: =Parent.Width
                                ZIndex: =1

                            lblunitdescriptionleaddescriptionLdS As label:
                                AutoHeight: =true
                                Color: =Header.SHRed
                                Text: =glryleadlistLS.Selected.UnitDescription
                                Width: =Parent.Width
                                ZIndex: =2

                        ctnscopeofworkleaddetailsldS As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =lblscopeofworkvalueleaddetailsLdS.Height+lblscopeofwokleaddetailsLdS.Height+20
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutJustifyContent: =LayoutJustifyContent.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =3

                            lblscopeofwokleaddetailsLdS As label:
                                FontWeight: =FontWeight.Bold
                                Height: =50
                                Text: ="Scope of work"
                                Width: =Parent.Width
                                ZIndex: =1

                            lblscopeofworkvalueleaddetailsLdS As label:
                                AutoHeight: =true
                                Color: =Header.SHRed
                                Text: =glryleadlistLS.Selected.PrimaryScopeofWorkLID.'PrimaryScopeofWorkName '
                                Width: =Parent.Width
                                ZIndex: =2

                        ctncustomscopeofworkleaddetailsLdS As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =lblcustomscopeofworkvalueleaddetailsLdS.Height+lblcustomscopeofworkleaddetailsLdS.Height+20
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutJustifyContent: =LayoutJustifyContent.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =4

                            lblcustomscopeofworkleaddetailsLdS As label:
                                FontWeight: =FontWeight.Bold
                                Height: =50
                                Text: ="Custom Scope of work"
                                Width: =Parent.Width
                                ZIndex: =1

                            lblcustomscopeofworkvalueleaddetailsLdS As label:
                                AutoHeight: =true
                                Color: =Header.SHRed
                                Text: =glryleadlistLS.Selected.CustomScopeofWork
                                Width: =Parent.Width
                                ZIndex: =2

                    icnunitinfoleaddetailsLdS As icon.Add:
                        Color: =RGBA(217, 217, 217, 1)
                        Fill: =RGBA(217, 217, 217, 1)
                        Height: =2
                        Icon: =Icon.HorizontalLine
                        Width: =Parent.Width-20
                        ZIndex: =6

                    ctnphotosmaterialinfoleaddetailsLdS As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: |-
                            =If(
                                ctnmaterialinfoleaddetailsLdS.Height > ctnphotoglryLdS.Height,
                                ctnmaterialinfoleaddetailsLdS.Height,
                                ctnmaterialinfoleaddetailsLdS.Height
                            )
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Width: =Parent.Width
                        X: =40
                        Y: =40
                        ZIndex: =7

                        ctnmaterialinfoleaddetailsLdS As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =lblmaterialleaddetailsLdS.Height+lblmaterialvalueleaddetailsLdS.Height+chbxunitdownLdS.Height+chbxadditionalexpensesLdS.Height+chbxtravelrequiredLdS.Height+chbxcommunucationLdS.Height+20
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =2

                            lblmaterialleaddetailsLdS As label:
                                FontWeight: =FontWeight.Bold
                                Height: =50
                                Text: ="Material Parts required and other things"
                                Width: =Parent.Width
                                ZIndex: =1

                            lblmaterialvalueleaddetailsLdS As label:
                                Color: =Header.SHRed
                                Text: =glryleadlistLS.Selected.Notes
                                Width: =Parent.Width
                                ZIndex: =2

                            chbxunitdownLdS As checkbox:
                                Default: =true
                                DisplayMode: =DisplayMode.View
                                FocusedBorderThickness: =//2
                                PressedBorderColor: =//ColorFade(Self.BorderColor, -30%)
                                Text: ="Unit Down"
                                Visible: =If(glryleadlistLS.Selected.IsUnitDown= 'IsUnitDown (LeadInformations)'.Yes,true,false)
                                Width: =Parent.Width
                                ZIndex: =3

                            chbxadditionalexpensesLdS As checkbox:
                                Default: =true
                                DisplayMode: =DisplayMode.View
                                FocusedBorderThickness: =//2
                                PressedBorderColor: =//ColorFade(Self.BorderColor, -30%)
                                Text: ="Additional expenses required"
                                Visible: =If(glryleadlistLS.Selected.AdditionalExpensesRequired= 'AdditionalExpensesRequired (LeadInformations)'.Yes,true,false)
                                Width: =Parent.Width
                                ZIndex: =4

                            chbxtravelrequiredLdS As checkbox:
                                Default: =true
                                DisplayMode: =DisplayMode.View
                                FocusedBorderThickness: =//2
                                PressedBorderColor: =//ColorFade(Self.BorderColor, -30%)
                                Text: ="Travel Required"
                                Visible: =If(glryleadlistLS.Selected.TravelRequired='TravelRequired (LeadInformations)'.Yes,true,false)
                                Width: =Parent.Width
                                ZIndex: =5

                            chbxcommunucationLdS As checkbox:
                                Default: =true
                                DisplayMode: =DisplayMode.View
                                FocusedBorderThickness: =//2
                                PressedBorderColor: =//ColorFade(Self.BorderColor, -30%)
                                Text: ="Communicated to Customer"
                                Visible: =If(glryleadlistLS.Selected.CommunicatedToCustomer = 'CommunicatedToCustomer (LeadInformations)'.Yes,true,false)
                                Width: =Parent.Width
                                ZIndex: =6

                        ctnphotoglryLdS As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            FillPortions: =2
                            Height: =lblphotosLdS.Height+glryphotosLdS.Height+20
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingLeft: =10
                            ZIndex: =3

                            lblphotosLdS As label:
                                FontWeight: =FontWeight.Bold
                                Height: =50
                                Text: ="Photos "
                                Width: =Parent.Width
                                ZIndex: =1

                            "glryphotosLdS As gallery.'BrowseLayout_Horizontal_TwoTextOneImageOverlayVariant_ver4.0'":
                                AlignInContainer: =AlignInContainer.SetByContainer
                                FillPortions: =0
                                Height: =230
                                Items: =Filter(LeadImages,LeadInformationLID.ID=glryleadlistLS.Selected.ID)
                                LayoutMinHeight: =287
                                LayoutMinWidth: =320
                                TemplatePadding: =0
                                TemplateSize: =Min(440, Self.Height - 60)
                                Width: =Parent.Width-40
                                ZIndex: =2

                                imgglryphotosLdS As image:
                                    BorderColor: =RGBA(26, 26, 26, 1)
                                    BorderThickness: =2
                                    Height: =Parent.TemplateHeight -10
                                    Image: =ThisItem.Images
                                    OnSelect: |-
                                        =UpdateContext({MyBigPic: ThisItem.Images.Full});UpdateContext({MyBigPicShow:true})
                                    Width: =Parent.TemplateWidth -10
                                    X: =5
                                    Y: =5
                                    ZIndex: =1

                    ctnapproverejectLdS As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =RGBA(0, 0, 0, 0.16)
                        Fill: =RGBA(249, 249, 249, 1)
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        Visible: =false
                        Width: =Parent.Width-40
                        X: =20
                        Y: =ctnphotosmaterialinfoleaddetailsLdS.Height+ctnphotosmaterialinfoleaddetailsLdS.Y
                        ZIndex: =8

                        lbl As label:
                            Height: =100
                            Size: =16
                            Text: ="Update lead status to send sales rep. requires Estimate Number to be entered. "
                            VerticalAlign: =VerticalAlign.Top
                            Visible: =false
                            Width: =800
                            X: =20
                            Y: =lblestimatenumberleaddetailsLdS.Height+lblestimatenumberleaddetailsLdS.Y
                            ZIndex: =1

                        lblestimatenumberleaddetailsLdS As label:
                            Color: =RGBA(54, 176, 75, 1)
                            FontWeight: =FontWeight.Semibold
                            Height: =80
                            Size: =16
                            Text: ="Estimate Number"
                            Width: =200
                            X: =20
                            Y: =30
                            ZIndex: =2

                        txtinptestimatenumber As text:
                            BorderColor: =RGBA(149, 149, 149, 1)
                            Color: =RGBA(116, 116, 116, 1)
                            Default: =LookUp(LeadInformations,ID=glryleadlistLS.Selected.ID,LeadEstimateNumber)
                            Height: =60
                            HintText: ="Enter Estimate Number"
                            HoverBorderColor: =//RGBA(0, 18, 107, 1)
                            HoverFill: =//RGBA(186, 202, 226, 1)
                            MaxLength: =11
                            OnChange: =Notify("Estimate number should not be greater than 11 digit.")
                            PaddingLeft: =20
                            X: =20
                            Y: =lblestimatenumberleaddetailsLdS.Height+lblestimatenumberleaddetailsLdS.Y //Label14_10.Height+Label14_10.Y
                            ZIndex: =3

                        btnestimatenumberLdS As button:
                            DisplayMode: =If((glryleadlistLS.Selected.LeadStatus="InProgress" /*||glryleadlistLS.Selected.LeadStatus="Quoted"*/) && glryleadlistLS.Selected.QQTeamName=User().FullName,DisplayMode.Edit,DisplayMode.Disabled)
                            Fill: =RGBA(54, 176, 75, 1)
                            Height: =60
                            HoverFill: =//ColorFade(RGBA(56, 96, 178, 1), -20%)
                            OnSelect: |
                                =//here checking estimate number is entered or not
                                If(
                                    IsBlank(txtinptestimatenumber.Text),
                                    Notify(
                                        "Please enter estimate number.",
                                        NotificationType.Information
                                    );
                                    Set(
                                        FlagEstimateNumberEntered,
                                        false
                                    ),
                                    Set(
                                        FlagEstimateNumberEntered,
                                        true
                                    )
                                );
                                //here checking entered estimate number is present in FP file or not
                                If(
                                    FlagEstimateNumberEntered = true,
                                    If(
                                        !IsBlank(
                                            LookUp(
                                                SHFPEstimates,
                                                Estimate = txtinptestimatenumber.Text && 'Lead Generator Id' = VarSelectedLead.TechnicianID
                                            )
                                        ),
                                        Set(
                                            FlagEstimateNumberFound,
                                            true
                                        );
                                        Set(
                                            VarFPEstimateData,
                                            LookUp(
                                                SHFPEstimates,
                                                Estimate = txtinptestimatenumber.Text
                                            )
                                        );
                                        Set(
                                            VarleadYear,
                                            LookUp(
                                                LeadInformations,
                                                ID = VarSelectedLead.ID,
                                                'Created On'
                                            )
                                        ),
                                        Notify("Estimate number not found in the FP Estimate file or Wrong Estimate number for this lead Technician is entered.");
                                        Set(
                                            FlagEstimateNumberFound,
                                            false
                                        );
                                    );
                                    
                                );
                                //here checking FlagEstimateNumberEntered & FlagEstimateNumberFound is true then update estimate number,leadprice,leadincentive
                                If(
                                    FlagEstimateNumberFound = true,
                                    UpdateIf(
                                        LeadInformations,
                                        ID = VarSelectedLead.ID,
                                        {
                                            LeadEstimateNumber: txtinptestimatenumber.Text,
                                            LeadStatus: "Quoted",
                                            'LeadPrice ': VarFPEstimateData.BidPrice,
                                            LeadIncentive: VarFPEstimateData.BidPrice * 0.02,
                                            TechnicianID: VarFPEstimateData.'Lead Generator Id'
                                        }
                                    );
                                    UpdateIf(
                                        TotalIncentives,
                                        TechnicianID = VarFPEstimateData.'Lead Generator Id' && Year = Text(Year(VarleadYear)),
                                        {
                                            TotalproposedIncentives: LookUp(
                                                TotalIncentives,
                                                TechnicianID = VarFPEstimateData.'Lead Generator Id' && Year = Text(Year(VarleadYear)),
                                                TotalproposedIncentives
                                            ) + VarFPEstimateData.BidPrice * 0.02,
                                            TotalProposedLead: Value(
                                                LookUp(
                                                    TotalIncentives,
                                                    TechnicianID = VarFPEstimateData.'Lead Generator Id' && Year = Text(Year(VarleadYear)),
                                                    TotalProposedLead
                                                )
                                            ) + 1
                                        }
                                    );
                                    Notify(
                                        "Proposed Incentives updated for the estimateId " & txtinptestimatenumber.Text,
                                        NotificationType.Success
                                    );
                                    Navigate(DashboardScreen);
                                    
                                );
                            Text: ="Submit Estimate Number"
                            Width: =300
                            X: =410
                            Y: =lblestimatenumberleaddetailsLdS.Height+lblestimatenumberleaddetailsLdS.Y //Label14_10.Height+Label14_10.Y
                            ZIndex: =4

                        lblrejectionLdS As label:
                            Color: =Header.SHRed
                            FontWeight: =FontWeight.Semibold
                            Height: =50
                            Size: =16
                            Text: ="Reject Lead"
                            Width: =200
                            X: =20
                            Y: =btnestimatenumberLdS.Height+btnestimatenumberLdS.Y+50
                            ZIndex: =5

                        lblcommentLdS As label:
                            Height: =100
                            Size: =16
                            Text: ="Send lead back to the technician along with comments."
                            Width: =800
                            X: =20
                            Y: =lblrejectionLdS.Height+lblrejectionLdS.Y
                            ZIndex: =6

                        txitnptrejectLdS As text:
                            BorderColor: =RGBA(149, 149, 149, 1)
                            Color: =RGBA(116, 116, 116, 1)
                            Default: =LookUp(LeadInformations,ID=glryleadlistLS.Selected.ID,LeadComment)
                            Height: =300
                            HintText: ="Add Rejection Comment"
                            HoverBorderColor: =//RGBA(0, 18, 107, 1)
                            HoverFill: =//RGBA(186, 202, 226, 1)
                            Mode: =TextMode.MultiLine
                            PaddingLeft: =20
                            PaddingTop: =20
                            Reset: =true
                            Width: =Parent.Width-100
                            X: =20
                            Y: =lblcommentLdS.Height+lblcommentLdS.Y
                            ZIndex: =7

                        btnbacktotechnicianLdS As button:
                            DisplayMode: =If(glryleadlistLS.Selected.LeadStatus="InProgress" && glryleadlistLS.Selected.QQTeamName=User().FullName,DisplayMode.Edit,DisplayMode.Disabled)
                            Fill: =Header.SHRed
                            Height: =60
                            HoverFill: =//ColorFade(RGBA(56, 96, 178, 1), -20%)
                            OnSelect: |-
                                =If(
                                    IsBlank(txitnptrejectLdS.Text),
                                    Notify("Please enter rejection comment."),
                                    UpdateIf(
                                        LeadInformations,
                                        ID = glryleadlistLS.Selected.ID,
                                        {
                                            LeadComment: txitnptrejectLdS.Text,
                                            LeadStatus: "Rejected"
                                        }
                                    );
                                    Notify("Lead rejected with comment successfully.");
                                )
                            Text: ="Submit back to technician"
                            Width: =300
                            X: =410
                            Y: =txitnptrejectLdS.Height+txitnptrejectLdS.Y+40
                            ZIndex: =8

            ctnapproverejectLdS_1 As groupContainer.manualLayoutContainer:
                BorderColor: =RGBA(0, 0, 0, 0.16)
                BorderThickness: =2
                Fill: =RGBA(249, 249, 249, 1)
                Height: =Parent.Height
                Visible: =VarLeadProposal
                Width: =Parent.Width-40
                X: =20
                ZIndex: =4

                lbl_1 As label:
                    Height: =100
                    Size: =16
                    Text: ="Update lead status to send sales rep. requires Estimate Number to be entered. "
                    VerticalAlign: =VerticalAlign.Top
                    Visible: =false
                    Width: =800
                    X: =20
                    Y: =lblestimatenumberleaddetailsLdS_1.Height+lblestimatenumberleaddetailsLdS_1.Y
                    ZIndex: =1

                lblestimatenumberleaddetailsLdS_1 As label:
                    Color: =RGBA(54, 176, 75, 1)
                    FontWeight: =FontWeight.Semibold
                    Height: =80
                    Size: =16
                    Text: ="Estimate Number"
                    Width: =200
                    X: =20
                    Y: =30
                    ZIndex: =2

                txtinptestimatenumber_1 As text:
                    BorderColor: =RGBA(149, 149, 149, 1)
                    Color: =RGBA(116, 116, 116, 1)
                    Default: =LookUp(LeadInformations,ID=glryleadlistLS.Selected.ID,LeadEstimateNumber)
                    Height: =60
                    HintText: ="Enter Estimate Number"
                    HoverBorderColor: =//RGBA(0, 18, 107, 1)
                    HoverFill: =//RGBA(186, 202, 226, 1)
                    MaxLength: =11
                    OnChange: =Notify("Estimate number should not be greater than 11 digit.")
                    PaddingLeft: =20
                    X: =20
                    Y: =lblestimatenumberleaddetailsLdS_1.Height+lblestimatenumberleaddetailsLdS_1.Y //Label14_10.Height+Label14_10.Y
                    ZIndex: =3

                btnestimatenumberLdS_1 As button:
                    DisplayMode: =If((glryleadlistLS.Selected.LeadStatus="InProgress" /*||glryleadlistLS.Selected.LeadStatus="Quoted"*/) && glryleadlistLS.Selected.QQTeamName=User().FullName,DisplayMode.Edit,DisplayMode.Disabled)
                    Fill: =RGBA(54, 176, 75, 1)
                    Height: =60
                    HoverFill: =//ColorFade(RGBA(56, 96, 178, 1), -20%)
                    OnSelect: |
                        =//here checking estimate number is entered or not
                        If(
                            IsBlank(txtinptestimatenumber_1.Text),
                            Notify(
                                "Please enter estimate number.",
                                NotificationType.Information
                            );
                            Set(
                                FlagEstimateNumberEntered,
                                false
                            ),
                            Set(
                                FlagEstimateNumberEntered,
                                true
                            )
                        );
                        //here checking entered estimate number is present in FP file or not
                        If(
                            FlagEstimateNumberEntered = true,
                            If(
                                !IsBlank(
                                    LookUp(
                                        SHFPEstimates,
                                        Estimate = txtinptestimatenumber_1.Text && 'Lead Generator Id' = VarSelectedLead.TechnicianID
                                    )
                                ),
                                Set(
                                    FlagEstimateNumberFound,
                                    true
                                );
                                Set(
                                    VarFPEstimateData,
                                    LookUp(
                                        SHFPEstimates,
                                        Estimate = txtinptestimatenumber_1.Text
                                    )
                                );
                                Set(
                                    VarleadYear,
                                    LookUp(
                                        LeadInformations,
                                        ID = VarSelectedLead.ID,
                                        'Created On'
                                    )
                                ),
                                Notify("Estimate number not found in the FP Estimate file or Wrong Estimate number for this lead Technician is entered.");
                                Set(
                                    FlagEstimateNumberFound,
                                    false
                                );
                            );
                            
                        );
                        //here checking FlagEstimateNumberEntered & FlagEstimateNumberFound is true then update estimate number,leadprice,leadincentive
                        If(
                            FlagEstimateNumberFound = true,
                            UpdateIf(
                                LeadInformations,
                                ID = VarSelectedLead.ID,
                                {
                                    LeadEstimateNumber: txtinptestimatenumber_1.Text,
                                    LeadStatus: "Quoted",
                                    'LeadPrice ': VarFPEstimateData.BidPrice,
                                    LeadIncentive: VarFPEstimateData.BidPrice * 0.02,
                                    TechnicianID: VarFPEstimateData.'Lead Generator Id',
                                    LeadDate:Now()
                                }
                            );
                            UpdateIf(
                                TotalIncentives,
                                TechnicianID = VarFPEstimateData.'Lead Generator Id' && Year = Text(Year(VarleadYear)),
                                {
                                    TotalproposedIncentives: LookUp(
                                        TotalIncentives,
                                        TechnicianID = VarFPEstimateData.'Lead Generator Id' && Year = Text(Year(VarleadYear)),
                                        TotalproposedIncentives
                                    ) + VarFPEstimateData.BidPrice * 0.02,
                                    TotalProposedLead: Value(
                                        LookUp(
                                            TotalIncentives,
                                            TechnicianID = VarFPEstimateData.'Lead Generator Id' && Year = Text(Year(VarleadYear)),
                                            TotalProposedLead
                                        )
                                    ) + 1
                                }
                            );
                            Notify(
                                "Proposed Incentives updated for the estimateId " & txtinptestimatenumber_1.Text,
                                NotificationType.Success
                            );
                            Navigate(DashboardScreen);
                            
                        );
                    Text: ="Submit Estimate Number"
                    Width: =300
                    X: =410
                    Y: =lblestimatenumberleaddetailsLdS_1.Height+lblestimatenumberleaddetailsLdS_1.Y //Label14_10.Height+Label14_10.Y
                    ZIndex: =4

                lblrejectionLdS_1 As label:
                    Color: =Header.SHRed
                    FontWeight: =FontWeight.Semibold
                    Height: =50
                    Size: =16
                    Text: ="Reject Lead"
                    Width: =200
                    X: =20
                    Y: =btnestimatenumberLdS_1.Height+btnestimatenumberLdS_1.Y+50
                    ZIndex: =5

                lblcommentLdS_1 As label:
                    Height: =100
                    Size: =16
                    Text: ="Send lead back to the technician along with comments."
                    Width: =800
                    X: =20
                    Y: =lblrejectionLdS_1.Height+lblrejectionLdS_1.Y
                    ZIndex: =6

                txitnptrejectLdS_1 As text:
                    BorderColor: =RGBA(149, 149, 149, 1)
                    Color: =RGBA(116, 116, 116, 1)
                    Default: =LookUp(LeadInformations,ID=glryleadlistLS.Selected.ID,LeadComment)
                    Height: =300
                    HintText: ="Add Rejection Comment"
                    HoverBorderColor: =//RGBA(0, 18, 107, 1)
                    HoverFill: =//RGBA(186, 202, 226, 1)
                    Mode: =TextMode.MultiLine
                    PaddingLeft: =20
                    PaddingTop: =20
                    Reset: =true
                    Width: =Parent.Width-100
                    X: =20
                    Y: =lblcommentLdS_1.Height+lblcommentLdS_1.Y
                    ZIndex: =7

                btnbacktotechnicianLdS_1 As button:
                    DisplayMode: =If(glryleadlistLS.Selected.LeadStatus="InProgress" && glryleadlistLS.Selected.QQTeamName=User().FullName,DisplayMode.Edit,DisplayMode.Disabled)
                    Fill: =Header.SHRed
                    Height: =60
                    HoverFill: =//ColorFade(RGBA(56, 96, 178, 1), -20%)
                    OnSelect: |-
                        =If(
                            IsBlank(txitnptrejectLdS_1.Text),
                            Notify("Please enter rejection comment."),
                            UpdateIf(
                                LeadInformations,
                                ID = glryleadlistLS.Selected.ID,
                                {
                                    LeadComment: txitnptrejectLdS_1.Text,
                                    LeadStatus: "Rejected",
                                    LeadDate:Now()
                                }
                            );
                            Notify("Lead rejected with comment successfully.");
                        )
                    Text: ="Submit back to technician"
                    Width: =300
                    X: =410
                    Y: =txitnptrejectLdS_1.Height+txitnptrejectLdS_1.Y+40
                    ZIndex: =8

        ctn As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =100
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            X: =19
            Y: =ctnmainLdS.Height+ctnmainLdS.Y
            ZIndex: =11

    ctnHeaderLeadScreen As groupContainer.manualLayoutContainer:
        Fill: =Header.SHRed
        Height: =80
        Width: =Parent.Width
        ZIndex: =2

        imguserLdS As image:
            Fill: =RGBA(253, 222, 207, 1)
            Height: =50
            Image: |-
                =//'man-avatar'
                User().Image
            RadiusBottomLeft: =91
            RadiusBottomRight: =91
            RadiusTopLeft: =91
            RadiusTopRight: =91
            Width: =50
            X: =lblheaderLdS.X+lblheaderLdS.Width
            Y: =16
            ZIndex: =1

        lblusernameLdS As label:
            Align: =Align.Center
            Color: =Header.White
            FontWeight: =FontWeight.Semibold
            Height: =Parent.Height
            Text: |-
                =//"Hi Sam Martin"
                User().FullName
            Width: =ctnHeaderLeadScreen.Width/8
            X: =imguserLdS.X+ imguserLdS.Height
            ZIndex: =2

        lblheaderLdS As label:
            Align: =Align.Center
            Color: =Header.White
            Fill: =Header.SHRed
            FontWeight: =FontWeight.Bold
            Height: =Parent.Height
            Size: =26
            Text: =If(VarMyLeads=true,"My Leads",VarOpenLeads=true,"Open Leads",VarQuotedLeads=true,"Quoted Leads",VarSoldLeads=true,"Sold Leads")
            Width: =ctnHeaderLeadScreen.Width/1.5
            X: =imgSchindlerlogoLdS.Width+imgSchindlerlogoLdS.X
            ZIndex: =3

        imgSchindlerlogoLdS As image:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Parent.Height
            Image: =SchindlerImage
            PaddingBottom: =5
            PaddingLeft: =2
            PaddingRight: =1
            PaddingTop: =5
            Width: =ctnHeaderLeadScreen.Width/10
            ZIndex: =4

    grpchatmessageLdS As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =10

        rectfullchatmessageLdS As rectangle:
            Fill: =RGBA(0, 0, 0, 0.29)
            Height: =Parent.Height
            Visible: =VarChatMessage
            Width: =Parent.Width
            ZIndex: =3

        rectchatmessage1LdS As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =405
            Visible: =VarChatMessage
            Width: =700
            X: =(Parent.Width -Self.Width)/2
            Y: =(Parent.Height - Self.Height)/2
            ZIndex: =4

        ctnchatmessageheadingLdS As groupContainer.horizontalAutoLayoutContainer:
            Height: =50
            LayoutMode: =LayoutMode.Auto
            Visible: =VarChatMessage
            Width: =rectchatmessage1LdS.Width
            X: =rectchatmessage1LdS.X
            Y: =rectchatmessage1LdS.Y+10
            ZIndex: =5

            lblchatmessageheadingLdS As label:
                FontWeight: =FontWeight.Semibold
                PaddingLeft: =20
                Text: |-
                    ="Enter message to technician : " & glryleadlistLS.Selected.MechanicName
                Width: =Parent.Width-70
                ZIndex: =1

            icnclosechatmessageLdS As icon.Cancel:
                Color: =RGBA(153, 153, 153, 1)
                Height: =35
                Icon: =Icon.Cancel
                OnSelect: |-
                    =Set(VarChatMessage,false);
                    Reset(txtinptchatmessageLdS);
                Width: =30
                ZIndex: =2

        rectchatmessageLdS As rectangle:
            BorderColor: =RGBA(179, 179, 179, 1)
            BorderThickness: =2
            Fill: =RGBA(255, 255, 255, 1)
            Height: =250
            Visible: =VarChatMessage
            Width: =656
            X: =rectchatmessage1LdS.X+20
            Y: =ctnchatmessageheadingLdS.Y+ctnchatmessageheadingLdS.Height +10
            ZIndex: =6

        icnhorizontallineLdS As icon.Add:
            Color: =RGBA(179, 179, 179, 1)
            Fill: =RGBA(179, 179, 179, 1)
            Height: =2
            Icon: =Icon.HorizontalLine
            Visible: =VarChatMessage
            Width: =rectchatmessageLdS.Width
            X: =rectchatmessageLdS.X
            Y: =rectchatmessageLdS.Y +rectchatmessageLdS.Height+10
            ZIndex: =7

        btnsendchatmessageLdS As button:
            BorderThickness: =0
            DisabledFill: =RGBA(237, 237, 237, 1)
            DisplayMode: |-
                =If(
                    Connection.Connected,
                    DisplayMode.Edit,
                    DisplayMode.Disabled
                )
            Fill: =Header.SHRed
            FocusedBorderThickness: =
            HoverFill: =//ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: |+
                =If(IsBlank(txtinptchatmessageLdS.Text),
                Notify("Please enter message to send",NotificationType.Warning); ,
                Patch(LeadChats,Defaults(LeadChats),
                {
                    ID:GUID(),
                    Message:txtinptchatmessageLdS.Text,
                    FromEmail:User().Email,
                    FromName:User().FullName,
                    ToEmail:glryleadlistLS.Selected.Email,
                    ToName:glryleadlistLS.Selected.MechanicName,
                    LeadInformationLID:LookUp(LeadInformations,ID=glryleadlistLS.Selected.ID),
                    IsQQApp:true
                });
                TechnicianMessage.Run(glryleadlistLS.Selected.Email,User().FullName,glryleadlistLS.Selected.'BuildingName ');
                If(
                        (!IsEmpty(Errors(LeadChats))),
                        Notify(
                            "Sending message Patch function Error -- " & Concat(
                                Errors(LeadChats),
                                Column & ": " & Message
                            ),
                            NotificationType.Error
                        );
                        ,
                        Reset(txtinptchatmessageLdS);
                Set(VarChatMessage,false);
                Notify("Message send successfully.",NotificationType.Success);
                    );
                );
                
                
                
            PressedColor: =Self.Color
            PressedFill: =Self.Fill
            Text: ="Send Message"
            Visible: =VarChatMessage
            X: =(Parent.Width-Self.Width)/2
            Y: =icnhorizontallineLdS.Y+20
            ZIndex: =8

        txtinptchatmessageLdS As text:
            BorderThickness: =0
            Default: =
            Fill: =RGBA(255,255,255,1)
            FocusedBorderColor: =RGBA(179, 179, 179, 1)
            FocusedBorderThickness: =2
            Height: =rectchatmessageLdS.Height
            HintText: ="Type here ..."
            HoverBorderColor: =RGBA(179, 179, 179, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            Mode: =TextMode.MultiLine
            PressedBorderColor: =RGBA(179, 179, 179, 1)
            RadiusBottomLeft: =20
            RadiusBottomRight: =20
            RadiusTopLeft: =20
            RadiusTopRight: =20
            Reset: =true
            Visible: =VarChatMessage
            Width: =rectchatmessageLdS.Width
            X: =rectchatmessageLdS.X
            Y: =rectchatmessageLdS.Y
            ZIndex: =9

    tmrgetmessage As timer:
        AutoPause: =false
        AutoStart: =false//VarLeadMessages
        Duration: =3000
        OnTimerEnd: =Refresh(LeadChats);
        Repeat: =true
        Start: =VarLeadMessages
        Visible: =false
        X: =40
        Y: =40
        ZIndex: =13

    Group1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =13

        Rectangle1 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Parent.Height
            Visible: = If(Len(Text(MyBigPicShow)) = 0,false,MyBigPicShow) 
            Width: =Parent.Width
            ZIndex: =10

        Image1 As image:
            Height: =Parent.Height
            Image: =MyBigPic 
            Visible: = If(Len(Text(MyBigPicShow)) = 0,false,MyBigPicShow) 
            Width: =Parent.Width
            ZIndex: =11

        Button1 As button:
            Color: =RGBA(102, 102, 102, 1)
            Fill: =RGBA(0, 0, 0, 0)
            FontWeight: =FontWeight.Normal
            Height: =100
            HoverColor: =//RGBA(255, 255, 255, 1)
            HoverFill: =//ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: |-
                =UpdateContext({MyBigPicShow:false})
            Size: =50
            Text: ="X"
            Visible: = If(Len(Text(MyBigPicShow)) = 0,false,MyBigPicShow)
            Width: =100
            X: =Parent.Width-Self.Width
            ZIndex: =12

    grpinprogressconfirmationLS_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =20

        rectfullinprogressconfirmtionLS_1 As rectangle:
            Fill: =RGBA(0, 0, 0, 0.29)
            Height: =Parent.Height
            Visible: =VarPopUpEstimateNumber
            Width: =Parent.Width
            ZIndex: =14

        rectinprogressconfirmationLS_1 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =280
            Visible: =VarPopUpEstimateNumber
            Width: =400
            X: =(Parent.Width-Self.Width)/2
            Y: =Parent.Height/3
            ZIndex: =15

        imginfoLS_1 As image:
            Height: =52
            Image: =images
            Visible: =VarPopUpEstimateNumber
            Width: =52
            X: =(Parent.Width-Self.Width)/2
            Y: =rectinprogressconfirmationLS_1.Y+20
            ZIndex: =16

        lblmsgLS_1 As label:
            Align: =Align.Center
            Font: =Font.Arial
            FontWeight: =FontWeight.Bold
            Height: =100
            Size: =15
            Text: ="Do you want to change estimate number?"
            Visible: =VarPopUpEstimateNumber
            Width: =350
            X: =(Parent.Width-Self.Width)/2
            Y: =imginfoLS_1.Y+ imginfoLS_1.Height+2
            ZIndex: =17

        btnyesLS_1 As button:
            Fill: =RGBA(54, 176, 75, 1)
            Font: =Font.Arial
            HoverFill: =RGBA(75, 125, 6, 1)
            OnSelect: |-
                =Set(VarPreviousIncentive,LookUp(LeadInformations,ID=glryleadlistLS.Selected.ID,LeadIncentive));
                Set(VarPopUpEstimateNumber,false);
            PressedBorderColor: =RGBA(1, 43, 1, 0)
            PressedFill: =Self.Fill
            Text: ="Yes"
            Visible: =VarPopUpEstimateNumber
            Width: =120
            X: =(Parent.Width-Self.Width)/2.3
            Y: =lblmsgLS_1.Y+ lblmsgLS_1.Height+10
            ZIndex: =18

        btnnoLS_1 As button:
            BorderColor: =RGBA(75, 125, 6, 1)
            Fill: =RGBA(54, 176, 75, 1)
            Font: =Font.Arial
            HoverBorderColor: =RGBA(75, 125, 6, 1)
            HoverFill: =RGBA(75, 125, 6, 1)
            OnSelect: =Set(VarPopUpEstimateNumber,false);
            PressedBorderColor: =RGBA(1, 43, 1, 0)
            PressedFill: =Self.Fill
            Text: ="No"
            Visible: =VarPopUpEstimateNumber
            Width: =120
            X: =btnyesLS_1.X+btnyesLS_1.Width+20
            Y: =lblmsgLS_1.Y+ lblmsgLS_1.Height+10
            ZIndex: =19

